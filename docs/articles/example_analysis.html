<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="beginr">
<title>Example Analysis • beginr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example Analysis">
<meta property="og:description" content="beginr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">beginr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../readme.html">intro</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../updates.html">news</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pzhaonet/beginr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example Analysis</h1>
                        <h4 data-toc-skip class="author">Yuan Gao</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pzhaonet/beginr/blob/HEAD/vignettes/example_analysis.Rmd" class="external-link"><code>vignettes/example_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>example_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="datasets-qestion">Datasets &amp; Qestion<a class="anchor" aria-label="anchor" href="#datasets-qestion"></a>
</h2>
<div class="section level3">
<h3 id="pick-up-the-dataset">pick up the dataset<a class="anchor" aria-label="anchor" href="#pick-up-the-dataset"></a>
</h3>
<p>in this part, I’ll use the <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-05-09/readme.md" class="external-link">TidyTuesday
patient children cost datasets</a> to conduct analysis.<br>
- original data download <a href="https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv" class="external-link">link</a>.<br>
- <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-05-09/readme.md#childcare_costscsv" class="external-link">data
dictionary</a></p>
</div>
<div class="section level3">
<h3 id="research-question">research question<a class="anchor" aria-label="anchor" href="#research-question"></a>
</h3>
<p>question: How do demographic and socio-economic factors influence the
median weekly cost of center-based childcare in different
counties/states in America?</p>
</div>
<div class="section level3">
<h3 id="loading-the-data">loading the data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the Data</span></span>
<span></span>
<span><span class="co"># Read in with tidytuesdayR package </span></span>
<span><span class="co"># Install from CRAN via: install.packages("tidytuesdayR")</span></span>
<span><span class="co"># This loads the readme and all the datasets for the week of interest</span></span>
<span></span>
<span><span class="co"># Either ISO-8601 date or year/week works!</span></span>
<span><span class="co"># tuesdata &lt;- tidytuesdayR::tt_load('2023-05-09')</span></span>
<span><span class="co"># tuesdata &lt;- tidytuesdayR::tt_load(2023, week = 19)</span></span>
<span><span class="co"># childcare_costs &lt;- tuesdata$childcare_costs</span></span>
<span><span class="co"># counties &lt;- tuesdata$counties</span></span>
<span></span>
<span><span class="co"># Or read in the data manually</span></span>
<span><span class="va">childcare_costs</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">34567</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">61</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (61): county_fips_code, study_year, unr_16, funr_16, munr_16, unr_20to64...</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counties</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/counties.csv'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">3144</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">4</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">## <span style="color: #BB0000;">chr</span> (3): county_name, state_name, state_abbreviation</span></span>
<span><span class="co">## <span style="color: #00BB00;">dbl</span> (1): county_fips_code</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
<ul>
<li>test if a directory named <code>data</code> exists locally.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check if the "data" directory exists</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># If it doesn't exist, create it</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<ul>
<li>Saves the data only once (not each time you knit/render the
document).</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="st">"data/childcare_costs.csv"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">childcare_costs</span>, <span class="va">file_path</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">counties_file_path</span> <span class="op">&lt;-</span> <span class="st">"data/counties.csv"</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">counties_file_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">counties</span>, <span class="va">counties_file_path</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<ul>
<li>Read in the data locally each time you knit/render.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-exploration-and-preprocessing">data exploration and preprocessing<a class="anchor" aria-label="anchor" href="#data-exploration-and-preprocessing"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/tigris" class="external-link">tigris</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## To enable caching of data, set `options(tigris_use_cache = TRUE)`</span></span>
<span><span class="co">## in your R script or .Rprofile.</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'purrr'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:maps':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     map</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pzhaonet/beginr" class="external-link">beginr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 34567</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># head(df)</span></span>
<span><span class="co"># colnames(df)</span></span></code></pre></div>
<p>here I selected the columns I’ll use later for my analysis.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Selecting specific columns from the dataframe and performing group-wise summary</span></span>
<span><span class="va">dft</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># Select relevant columns for analysis</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>        <span class="co"># FIPS code identifying counties</span></span>
<span>        <span class="st">'county_fips_code'</span>, </span>
<span>        </span>
<span>        <span class="co"># Unemployment rates by gender for population aged 16 or older</span></span>
<span>        <span class="st">'funr_16'</span>, <span class="co"># Female unemployment rate</span></span>
<span>        <span class="st">'munr_16'</span>, <span class="co"># Male unemployment rate</span></span>
<span>        </span>
<span>        <span class="co"># Labor force participation rates for women aged 20 to 64 with children in different age groups</span></span>
<span>        <span class="st">'flfpr_20to64_under6'</span>, <span class="co"># With children under 6 years</span></span>
<span>        <span class="st">'flfpr_20to64_6to17'</span>,  <span class="co"># With children aged 6 to 17 years</span></span>
<span>        </span>
<span>        <span class="co"># Poverty rate among families</span></span>
<span>        <span class="st">'pr_f'</span>,</span>
<span>        </span>
<span>        <span class="co"># Total population count</span></span>
<span>        <span class="st">'total_pop'</span>,</span>
<span>        </span>
<span>        <span class="co"># Population counts by race</span></span>
<span>        <span class="st">'one_race_w'</span>, <span class="co"># White</span></span>
<span>        <span class="st">'one_race_b'</span>, <span class="co"># Black</span></span>
<span>        <span class="st">'one_race_i'</span>, <span class="co"># American Indian/Alaska Native</span></span>
<span>        <span class="st">'one_race_a'</span>, <span class="co"># Asian</span></span>
<span>        <span class="st">'one_race_h'</span>, <span class="co"># Hispanic/Latino</span></span>
<span>        <span class="st">'one_race_other'</span>, <span class="co"># Other race</span></span>
<span></span>
<span>        <span class="co"># Household counts with children, categorizing by parental work status</span></span>
<span>        <span class="st">'h_6to17_both_work'</span>, <span class="co"># Both parents working</span></span>
<span>        <span class="st">'h_6to17_fwork'</span>,     <span class="co"># Only female parent working</span></span>
<span>        <span class="st">'h_6to17_mwork'</span>,     <span class="co"># Only male parent working</span></span>
<span>        </span>
<span>        <span class="co"># Households with single mothers and children in different age groups</span></span>
<span>        <span class="st">'h_under6_single_m'</span>, <span class="co"># With children under 6 years</span></span>
<span>        <span class="st">'h_6to17_single_m'</span>,  <span class="co"># With children aged 6 to 17 years</span></span>
<span>        </span>
<span>        <span class="co"># Median weekly cost of center-based care for children of different age groups</span></span>
<span>        <span class="st">'mc_infant'</span>,    <span class="co"># Infant care</span></span>
<span>        <span class="st">'mc_toddler'</span>,   <span class="co"># Toddler care</span></span>
<span>        <span class="st">'mc_preschool'</span>  <span class="co"># Preschool care</span></span>
<span>    <span class="op">)</span> </span>
<span></span>
<span><span class="va">mean_dft</span> <span class="op">&lt;-</span> <span class="va">dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">county_fips_code</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: There was 1 warning in `summarize()`.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> In argument: `across(everything(), mean, na.rm = TRUE)`.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> In group 1: `county_fips_code = 1001`.</span></span>
<span><span class="co">## Caused by warning:</span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> The `...` argument of `across()` is deprecated as of dplyr 1.1.0.</span></span>
<span><span class="co">## Supply arguments directly to `.fns` through an anonymous function instead.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   # Previously</span></span>
<span><span class="co">##   across(a:b, mean, na.rm = TRUE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   # Now</span></span>
<span><span class="co">##   across(a:b, \(x) mean(x, na.rm = TRUE))</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sum_cost</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># total unemployment population: </span></span>
<span><span class="va">Unem_pop</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">c</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">(</span><span class="va">a</span><span class="op">+</span><span class="va">b</span><span class="op">)</span><span class="op">*</span><span class="va">c</span></span>
<span><span class="op">}</span></span>
<span><span class="va">test_mean_dft</span> <span class="op">&lt;-</span> <span class="va">mean_dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tot_unem_pop <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap_dbl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">funr_16</span>, <span class="va">munr_16</span>, <span class="va">total_pop</span><span class="op">)</span>, <span class="va">Unem_pop</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mean_dft</span> <span class="op">&lt;-</span> <span class="va">mean_dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap_dbl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mc_infant</span>, <span class="va">mc_toddler</span>, <span class="va">mc_preschool</span><span class="op">)</span>, <span class="va">sum_cost</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mean_dft</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">mean_dft</span>, <span class="va">county_fips_code</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mean_dft</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 22</span></span></span>
<span><span class="co">##   county_fips_code funr_16 munr_16 flfpr_20to64_under6 flfpr_20to64_6to17  pr_f</span></span>
<span><span class="co">##              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>             <span style="text-decoration: underline;">1</span>001    6.92    6.59                66.7               76.7  8.85</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>             <span style="text-decoration: underline;">1</span>003    6.73    6.72                67.6               76.4  9.05</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>             <span style="text-decoration: underline;">1</span>005   12.1    12.7                 69.8               73.1 20.2 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>             <span style="text-decoration: underline;">1</span>007   10.4     6.84                61.5               67.8 11.6 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>             <span style="text-decoration: underline;">1</span>009    7.17    7.18                63.8               66.1 10.8 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>             <span style="text-decoration: underline;">1</span>011   15.0    12.0                 74.4               61.9 24.4 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 16 more variables: total_pop &lt;dbl&gt;, one_race_w &lt;dbl&gt;, one_race_b &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   one_race_i &lt;dbl&gt;, one_race_a &lt;dbl&gt;, one_race_h &lt;dbl&gt;, one_race_other &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   h_6to17_both_work &lt;dbl&gt;, h_6to17_fwork &lt;dbl&gt;, h_6to17_mwork &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   h_under6_single_m &lt;dbl&gt;, h_6to17_single_m &lt;dbl&gt;, mc_infant &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   mc_toddler &lt;dbl&gt;, mc_preschool &lt;dbl&gt;, cost &lt;dbl&gt;</span></span></span></code></pre>
<p>Here performed a correlation analysis to explore the pairwise
relationships between independent variables (demographic and
socio-economic factors) and the dependent variable (cost of
childcare).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: carData</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'car'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:purrr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     some</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     recode</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot" class="external-link">corrplot</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## corrplot 0.92 loaded</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mean_dft</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  county_fips_code    funr_16          munr_16       flfpr_20to64_under6</span></span>
<span><span class="co">##  Min.   : 1001    Min.   : 0.000   Min.   : 0.000   Min.   :16.08      </span></span>
<span><span class="co">##  1st Qu.:18176    1st Qu.: 5.011   1st Qu.: 5.697   1st Qu.:63.57      </span></span>
<span><span class="co">##  Median :29176    Median : 6.745   Median : 7.658   Median :69.54      </span></span>
<span><span class="co">##  Mean   :30381    Mean   : 7.028   Mean   : 7.859   Mean   :68.83      </span></span>
<span><span class="co">##  3rd Qu.:45082    3rd Qu.: 8.697   3rd Qu.: 9.645   3rd Qu.:74.55      </span></span>
<span><span class="co">##  Max.   :56045    Max.   :24.513   Max.   :30.913   Max.   :96.08      </span></span>
<span><span class="co">##                                                                        </span></span>
<span><span class="co">##  flfpr_20to64_6to17      pr_f          total_pop         one_race_w    </span></span>
<span><span class="co">##  Min.   :14.89      Min.   : 0.000   Min.   :     77   Min.   : 7.289  </span></span>
<span><span class="co">##  1st Qu.:74.72      1st Qu.: 7.842   1st Qu.:  10979   1st Qu.:77.123  </span></span>
<span><span class="co">##  Median :79.44      Median :10.854   Median :  25736   Median :90.025  </span></span>
<span><span class="co">##  Mean   :78.83      Mean   :11.738   Mean   :  99096   Mean   :83.630  </span></span>
<span><span class="co">##  3rd Qu.:83.86      3rd Qu.:14.406   3rd Qu.:  66666   3rd Qu.:95.555  </span></span>
<span><span class="co">##  Max.   :99.98      Max.   :43.767   Max.   :9924587   Max.   :99.467  </span></span>
<span><span class="co">##                                                                        </span></span>
<span><span class="co">##    one_race_b        one_race_i        one_race_a        one_race_h      </span></span>
<span><span class="co">##  Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.00000  </span></span>
<span><span class="co">##  1st Qu.: 0.5545   1st Qu.: 0.1909   1st Qu.: 0.2818   1st Qu.: 0.00000  </span></span>
<span><span class="co">##  Median : 2.1136   Median : 0.3454   Median : 0.5182   Median : 0.01818  </span></span>
<span><span class="co">##  Mean   : 8.9703   Mean   : 1.9002   Mean   : 1.2164   Mean   : 0.08219  </span></span>
<span><span class="co">##  3rd Qu.:10.2609   3rd Qu.: 0.7818   3rd Qu.: 1.1182   3rd Qu.: 0.06364  </span></span>
<span><span class="co">##  Max.   :86.1882   Max.   :86.2755   Max.   :43.4818   Max.   :22.85545  </span></span>
<span><span class="co">##                                                                          </span></span>
<span><span class="co">##  one_race_other    h_6to17_both_work  h_6to17_fwork      h_6to17_mwork     </span></span>
<span><span class="co">##  Min.   : 0.0000   Min.   :     0.0   Min.   :     0.0   Min.   :    0.00  </span></span>
<span><span class="co">##  1st Qu.: 0.3400   1st Qu.:   685.6   1st Qu.:   257.4   1st Qu.:   46.25  </span></span>
<span><span class="co">##  Median : 0.8632   Median :  1660.1   Median :   611.9   Median :  117.09  </span></span>
<span><span class="co">##  Mean   : 2.1170   Mean   :  6477.5   Mean   :  2873.0   Mean   :  389.93  </span></span>
<span><span class="co">##  3rd Qu.: 2.2818   3rd Qu.:  4448.4   3rd Qu.:  1776.4   3rd Qu.:  296.73  </span></span>
<span><span class="co">##  Max.   :36.7636   Max.   :554732.8   Max.   :352966.6   Max.   :37233.82  </span></span>
<span><span class="co">##                                                                            </span></span>
<span><span class="co">##  h_under6_single_m  h_6to17_single_m     mc_infant        mc_toddler    </span></span>
<span><span class="co">##  Min.   :     0.0   Min.   :     0.0   Min.   : 27.73   Min.   : 21.54  </span></span>
<span><span class="co">##  1st Qu.:   184.2   1st Qu.:   362.1   1st Qu.:109.00   1st Qu.:100.51  </span></span>
<span><span class="co">##  Median :   495.1   Median :   904.4   Median :135.04   Median :120.81  </span></span>
<span><span class="co">##  Mean   :  1991.2   Mean   :  3922.5   Mean   :147.50   Mean   :132.76  </span></span>
<span><span class="co">##  3rd Qu.:  1290.5   3rd Qu.:  2398.9   3rd Qu.:163.93   3rd Qu.:150.30  </span></span>
<span><span class="co">##  Max.   :209341.5   Max.   :425656.9   Max.   :409.88   Max.   :377.82  </span></span>
<span><span class="co">##                                        NA's   :240      NA's   :240     </span></span>
<span><span class="co">##   mc_preschool         cost        </span></span>
<span><span class="co">##  Min.   : 21.54   Min.   :  70.81  </span></span>
<span><span class="co">##  1st Qu.: 96.25   1st Qu.: 309.13  </span></span>
<span><span class="co">##  Median :115.60   Median : 371.41  </span></span>
<span><span class="co">##  Mean   :124.08   Mean   : 404.34  </span></span>
<span><span class="co">##  3rd Qu.:138.65   3rd Qu.: 450.62  </span></span>
<span><span class="co">##  Max.   :327.80   Max.   :1092.55  </span></span>
<span><span class="co">##  NA's   :240      NA's   :240</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">high_cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mean_dft</span>, <span class="va">cost</span> <span class="op">&gt;</span> <span class="fl">450</span><span class="op">)</span></span>
<span><span class="va">data_for_correlation</span> <span class="op">&lt;-</span> <span class="va">mean_dft</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># Excludes the first column (county_fips_code)</span></span>
<span><span class="va">correlation_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data_for_correlation</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span>  <span class="co"># Handling missing values</span></span>
<span><span class="va">cost_correlations</span> <span class="op">&lt;-</span> <span class="va">correlation_matrix</span><span class="op">[</span><span class="st">"cost"</span>, <span class="op">]</span></span>
<span><span class="va">cost_correlations</span></span></code></pre></div>
<pre><code><span><span class="co">##             funr_16             munr_16 flfpr_20to64_under6  flfpr_20to64_6to17 </span></span>
<span><span class="co">##         -0.15317016         -0.09291397          0.13134007          0.17792157 </span></span>
<span><span class="co">##                pr_f           total_pop          one_race_w          one_race_b </span></span>
<span><span class="co">##         -0.44523957          0.35729097          0.05962818         -0.19444226 </span></span>
<span><span class="co">##          one_race_i          one_race_a          one_race_h      one_race_other </span></span>
<span><span class="co">##         -0.04967108          0.52733806          0.14589075          0.18792870 </span></span>
<span><span class="co">##   h_6to17_both_work       h_6to17_fwork       h_6to17_mwork   h_under6_single_m </span></span>
<span><span class="co">##          0.39036964          0.31209180          0.35106121          0.27836428 </span></span>
<span><span class="co">##    h_6to17_single_m           mc_infant          mc_toddler        mc_preschool </span></span>
<span><span class="co">##          0.29754599          0.99064522          0.99098875          0.99197233 </span></span>
<span><span class="co">##                cost </span></span>
<span><span class="co">##          1.00000000</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># corrplot(correlation_matrix, method = "circle")</span></span>
<span></span>
<span></span>
<span><span class="co"># Reshaping the correlation matrix into a long format</span></span>
<span><span class="va">correlation_matrix_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">correlation_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">correlation_matrix_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Var1</span>, y <span class="op">=</span> <span class="va">Var2</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>                       midpoint <span class="op">=</span> <span class="fl">0</span>, limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, space <span class="op">=</span> <span class="st">"Lab"</span>, </span>
<span>                       name<span class="op">=</span><span class="st">"Correlation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Variable 1'</span>, </span>
<span>    y <span class="op">=</span> <span class="st">'Variable 2'</span>, </span>
<span>    title <span class="op">=</span> <span class="st">'Correlation Matrix Using ggplot2'</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">'Visualization of Pairwise Correlation Coefficients'</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">'Source: Tidy Tuesday Dataset'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="example_analysis_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the function chosen from the beginr package in github</span></span>
<span><span class="va">plt_test</span> <span class="op">&lt;-</span> <span class="va">mean_dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cost</span>, <span class="va">funr_16</span>, <span class="va">munr_16</span><span class="op">)</span></span>
<span><span class="fu">beginr</span><span class="fu">::</span><span class="fu"><a href="../reference/plotpairs.html">plotpairs</a></span><span class="op">(</span><span class="va">plt_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in par(usr): argument 1 does not name a graphical parameter</span></span>
<span></span>
<span><span class="co">## Warning in par(usr): argument 1 does not name a graphical parameter</span></span>
<span></span>
<span><span class="co">## Warning in par(usr): argument 1 does not name a graphical parameter</span></span></code></pre>
<p><img src="example_analysis_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">beginr</span><span class="fu">::</span><span class="fu"><a href="../reference/plottype.html">plottype</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_analysis_files/figure-html/unnamed-chunk-9-2.png" width="672"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">beginr</span><span class="fu">::</span><span class="fu"><a href="../reference/plothist.html">plothist</a></span><span class="op">(</span><span class="va">mean_dft</span><span class="op">$</span><span class="va">mc_toddler</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_analysis_files/figure-html/unnamed-chunk-9-3.png" width="672"></p>
<p>VIF check</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exclude non-independent variables</span></span>
<span><span class="va">independent_data</span> <span class="op">&lt;-</span> <span class="va">mean_dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">cost</span>, <span class="op">-</span><span class="va">mc_infant</span>, <span class="op">-</span><span class="va">mc_toddler</span>, <span class="op">-</span><span class="va">mc_preschool</span><span class="op">)</span>  </span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">funr_16</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">independent_data</span><span class="op">)</span>  <span class="co"># Replace 'county_fips_code' with an appropriate variable if needed</span></span>
<span><span class="va">vif_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">vif_values</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    county_fips_code             munr_16 flfpr_20to64_under6  flfpr_20to64_6to17 </span></span>
<span><span class="co">##            1.055657            2.033534            1.540107            1.582684 </span></span>
<span><span class="co">##                pr_f           total_pop          one_race_w          one_race_b </span></span>
<span><span class="co">##            2.972643          135.610125          133.532494          103.092204 </span></span>
<span><span class="co">##          one_race_i          one_race_a          one_race_h      one_race_other </span></span>
<span><span class="co">##           32.226441            6.449915            2.022012            7.561551 </span></span>
<span><span class="co">##   h_6to17_both_work       h_6to17_fwork       h_6to17_mwork   h_under6_single_m </span></span>
<span><span class="co">##           59.390005           28.079830           38.975255          249.359191 </span></span>
<span><span class="co">##    h_6to17_single_m </span></span>
<span><span class="co">##          368.354809</span></span></code></pre>
<p>plot the cost map for each couunty to compare.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first check total cost </span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">mean_dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">county_fips_code</span>, <span class="va">cost</span><span class="op">)</span></span>
<span><span class="co"># Download county and state boundaries</span></span>
<span><span class="va">counties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/counties.html" class="external-link">counties</a></span><span class="op">(</span>cb <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">## Retrieving data for the year 2021</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/states.html" class="external-link">states</a></span><span class="op">(</span>cb <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Retrieving data for the year 2021</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">states</span><span class="op">$</span><span class="va">centroid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">states</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="va">states</span><span class="op">$</span><span class="va">abbr</span> <span class="op">&lt;-</span> <span class="va">state.abb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">states</span><span class="op">$</span><span class="va">NAME</span>, <span class="va">state.name</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ensure FIPS is character type</span></span>
<span><span class="va">counties</span><span class="op">$</span><span class="va">fips</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">counties</span><span class="op">$</span><span class="va">GEOID</span><span class="op">)</span>  </span>
<span><span class="va">test</span><span class="op">$</span><span class="va">county_fips_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">county_fips_code</span><span class="op">)</span></span>
<span><span class="va">map_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">counties</span>, <span class="va">test</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fips"</span> <span class="op">=</span> <span class="st">"county_fips_code"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">map_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">cost</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">states</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">states</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">abbr</span>, x <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">centroid</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">centroid</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, check_overlap <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Mean Cost"</span>, option <span class="op">=</span> <span class="st">"C"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mean Value of Cost by County"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Comparison of Childcare Costs Across Different Counties"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Source: Childcare Cost Data | Map Data: US Census Bureau"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">130</span>, <span class="op">-</span><span class="fl">60</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span><span class="op">)</span>, datum <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values (`geom_text()`).</span></span></code></pre>
<p><img src="example_analysis_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fisrt check total cost </span></span>
<span><span class="va">test_1</span> <span class="op">&lt;-</span> <span class="va">mean_dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">county_fips_code</span>, <span class="va">mc_infant</span><span class="op">)</span></span>
<span><span class="co"># Download county and state boundaries</span></span>
<span><span class="va">counties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/counties.html" class="external-link">counties</a></span><span class="op">(</span>cb <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">## Retrieving data for the year 2021</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/states.html" class="external-link">states</a></span><span class="op">(</span>cb <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Retrieving data for the year 2021</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">states</span><span class="op">$</span><span class="va">centroid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">states</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span></span>
<span><span class="va">states</span><span class="op">$</span><span class="va">abbr</span> <span class="op">&lt;-</span> <span class="va">state.abb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">states</span><span class="op">$</span><span class="va">NAME</span>, <span class="va">state.name</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ensure FIPS is character type</span></span>
<span><span class="va">counties</span><span class="op">$</span><span class="va">fips</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">counties</span><span class="op">$</span><span class="va">GEOID</span><span class="op">)</span>  </span>
<span><span class="va">test_1</span><span class="op">$</span><span class="va">county_fips_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">test_1</span><span class="op">$</span><span class="va">county_fips_code</span><span class="op">)</span></span>
<span><span class="va">map_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">counties</span>, <span class="va">test_1</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fips"</span> <span class="op">=</span> <span class="st">"county_fips_code"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">map_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">mc_infant</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">states</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">states</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">abbr</span>, x <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">centroid</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">centroid</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, check_overlap <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Mean Infant Cost"</span>, option <span class="op">=</span> <span class="st">"C"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mean Value of Infant Cost by County"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Comparison of Childcare Costs Across Different Counties"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Source: Childcare Cost Data | Map Data: US Census Bureau"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">130</span>, <span class="op">-</span><span class="fl">60</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span><span class="op">)</span>, datum <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values (`geom_text()`).</span></span></code></pre>
<p><img src="example_analysis_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>check the costs value distribution</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'tidyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:reshape2':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     smiths</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reshape the data to long format for faceting</span></span>
<span><span class="va">long_data</span> <span class="op">&lt;-</span> <span class="va">mean_dft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cost</span>, <span class="va">mc_infant</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot using ggplot2 with facet_wrap</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">long_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Total Cost and Infant Cost"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Comparative Analysis of Cost Distributions"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Source: Tidy Tuesday dataset"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Cost Value"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency of Occurrence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 480 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="example_analysis_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="model-and-results">model and results<a class="anchor" aria-label="anchor" href="#model-and-results"></a>
</h3>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mean_dft</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "county_fips_code"    "funr_16"             "munr_16"            </span></span>
<span><span class="co">##  [4] "flfpr_20to64_under6" "flfpr_20to64_6to17"  "pr_f"               </span></span>
<span><span class="co">##  [7] "total_pop"           "one_race_w"          "one_race_b"         </span></span>
<span><span class="co">## [10] "one_race_i"          "one_race_a"          "one_race_h"         </span></span>
<span><span class="co">## [13] "one_race_other"      "h_6to17_both_work"   "h_6to17_fwork"      </span></span>
<span><span class="co">## [16] "h_6to17_mwork"       "h_under6_single_m"   "h_6to17_single_m"   </span></span>
<span><span class="co">## [19] "mc_infant"           "mc_toddler"          "mc_preschool"       </span></span>
<span><span class="co">## [22] "cost"</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">cost</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="va">county_fips_code</span> <span class="op">-</span> <span class="va">mc_infant</span> <span class="op">-</span> <span class="va">mc_toddler</span> <span class="op">-</span> <span class="va">mc_preschool</span>, data <span class="op">=</span> <span class="va">mean_dft</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = cost ~ . - county_fips_code - mc_infant - mc_toddler - </span></span>
<span><span class="co">##     mc_preschool, data = mean_dft)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -380.37  -58.25   -9.28   41.92  530.09 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)          8.237e+02  1.247e+02   6.604 4.76e-11 ***</span></span>
<span><span class="co">## funr_16             -2.471e+00  1.111e+00  -2.223 0.026278 *  </span></span>
<span><span class="co">## munr_16              1.244e+01  9.673e-01  12.863  &lt; 2e-16 ***</span></span>
<span><span class="co">## flfpr_20to64_under6  1.436e-01  2.461e-01   0.584 0.559460    </span></span>
<span><span class="co">## flfpr_20to64_6to17   5.772e-02  2.769e-01   0.208 0.834886    </span></span>
<span><span class="co">## pr_f                -1.242e+01  5.766e-01 -21.539  &lt; 2e-16 ***</span></span>
<span><span class="co">## total_pop            3.271e-05  6.282e-05   0.521 0.602597    </span></span>
<span><span class="co">## one_race_w          -4.153e+00  1.272e+00  -3.265 0.001107 ** </span></span>
<span><span class="co">## one_race_b          -4.672e+00  1.275e+00  -3.664 0.000253 ***</span></span>
<span><span class="co">## one_race_i          -3.724e+00  1.406e+00  -2.648 0.008144 ** </span></span>
<span><span class="co">## one_race_a           1.443e+01  1.816e+00   7.945 2.75e-15 ***</span></span>
<span><span class="co">## one_race_h          -4.980e+01  1.001e+01  -4.975 6.91e-07 ***</span></span>
<span><span class="co">## one_race_other       1.649e+00  1.461e+00   1.129 0.259201    </span></span>
<span><span class="co">## h_6to17_both_work    4.487e-03  6.842e-04   6.558 6.44e-11 ***</span></span>
<span><span class="co">## h_6to17_fwork       -8.801e-03  8.373e-04 -10.511  &lt; 2e-16 ***</span></span>
<span><span class="co">## h_6to17_mwork        9.923e-03  9.014e-03   1.101 0.271047    </span></span>
<span><span class="co">## h_under6_single_m   -6.331e-03  3.909e-03  -1.619 0.105475    </span></span>
<span><span class="co">## h_6to17_single_m     3.300e-03  2.387e-03   1.382 0.166963    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 94.83 on 2886 degrees of freedom</span></span>
<span><span class="co">##   (240 observations deleted due to missingness)</span></span>
<span><span class="co">## Multiple R-squared:  0.5114, Adjusted R-squared:  0.5085 </span></span>
<span><span class="co">## F-statistic: 177.7 on 17 and 2886 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Residual plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_analysis_files/figure-html/plot-result-1.png" width="672"><img src="example_analysis_files/figure-html/plot-result-2.png" width="672"><img src="example_analysis_files/figure-html/plot-result-3.png" width="672"><img src="example_analysis_files/figure-html/plot-result-4.png" width="672"></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Q-Q plot for normality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqline</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_analysis_files/figure-html/plot-result-5.png" width="672"></p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># VIF to check for multicollinearity</span></span>
<span><span class="va">vif_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html" class="external-link">vif</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">vif_model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             funr_16             munr_16 flfpr_20to64_under6  flfpr_20to64_6to17 </span></span>
<span><span class="co">##            3.724431            3.476933            1.553709            1.607463 </span></span>
<span><span class="co">##                pr_f           total_pop          one_race_w          one_race_b </span></span>
<span><span class="co">##            3.200913          137.971195          138.898555          116.580022 </span></span>
<span><span class="co">##          one_race_i          one_race_a          one_race_h      one_race_other </span></span>
<span><span class="co">##           26.470602            5.863149            1.497708            7.483987 </span></span>
<span><span class="co">##   h_6to17_both_work       h_6to17_fwork       h_6to17_mwork   h_under6_single_m </span></span>
<span><span class="co">##           60.239116           28.864265           39.313622          258.651302 </span></span>
<span><span class="co">##    h_6to17_single_m </span></span>
<span><span class="co">##          383.328391</span></span></code></pre>
<p>based on the results using linear regression, it can be seen that the
childcare cost is related to the race, unemployment rates by gender,
poverty rate among families, and parental work status. Based on the map
plot, WA have higher costs compare to other states in US.</p>
</div>
<div class="section level3">
<h3 id="the-function-i-used">the function i used<a class="anchor" aria-label="anchor" href="#the-function-i-used"></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code>,
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by()</a></code>,
<code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code>,<code>arrange</code></p>
<p>different <code>geom_*()</code> functions from <code>ggplot2</code>:
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf()</a></code>,
<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text()</a></code>,<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile()</a></code>,<code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram()</a></code></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peng Zhao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
